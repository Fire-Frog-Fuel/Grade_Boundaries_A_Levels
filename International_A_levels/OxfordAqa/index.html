<!doctype html>
<html lang="en">
  <head>
    <!-- ✨ SEO & performance enhancements for Oxford AQA page (no functional changes) ✨ -->
    <style id="css-cloak">
      html:not(.css-loaded) body > * {
        display: none;
      }
    </style>

    <!-- Preconnect hints -->
    <link rel="preconnect" href="https://plausible.io" />
    <link rel="preconnect" href="https://gc.zgo.at" />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="preconnect" href="https://cdn.datatables.net" />
    <link rel="preconnect" href="https://code.jquery.com" />

    <!-- Analytics (kept) -->
    <script
      defer
      data-domain="gradeboundaries.com"
      src="https://plausible.io/js/script.js"
    ></script>
    <script
      data-goatcounter="https://gradeboundaries.goatcounter.com/count"
      async
      src="//gc.zgo.at/count.js"
    ></script>

    <!-- Base-href, CSS injection (unchanged) -->
    <script>
      function uncloak() {
        document.documentElement.classList.add("css-loaded");
        const c = document.getElementById("css-cloak");
        if (c) c.remove();
      }
      const host = location.hostname;
      const myBase =
        host === "gradeboundaries.com" ? "/" : "/Grade_Boundaries_A_Levels/";
      const base = document.createElement("base");
      base.href = myBase;
      document.head.appendChild(base);
      const t1 = document.createElement("link");
      t1.rel = "stylesheet";
      t1.href = "dist/output.css";
      document.head.appendChild(t1);
      const t2 = document.createElement("link");
      t2.rel = "stylesheet";
      t2.href = "style.css";
      t2.onload = uncloak;
      document.head.appendChild(t2);
    </script>

    <!-- Primary meta -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Oxford AQA A-Level Grade Boundaries 2020-2025 | Interactive Tables & CSV
    </title>
    <meta
      name="description"
      content="Oxford AQA A-Level grade boundaries (2020-2025) – part of Grade-Boundary Explorer, the one-stop hub where every UK exam board’s thresholds live together. Filter tables, plot trends and grab a free CSV."
    />
    <meta
      name="keywords"
      content="Oxford AQA grade boundaries, A Level grade thresholds, Oxford AQA 2025, exam results, UK A-Levels"
    />
    <meta name="author" content="Fire-Frog-Fuel" />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#111827" />

    <!-- Canonical & hreflang -->
    <link rel="canonical" href="https://gradeboundaries.com/International_A_levels/OxfordAqa" />
    <link
      rel="alternate"
      hreflang="en-gb"
      href="https://gradeboundaries.com/International_A_levels/OxfordAqa"
    />
    <link
      rel="alternate"
      hreflang="x-default"
      href="https://gradeboundaries.com/International_A_levels/OxfordAqa"
    />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Grade-Boundary Explorer" />
    <meta property="og:locale" content="en_GB" />
    <meta property="og:url" content="https://gradeboundaries.com/International_A_levels/OxfordAqa" />
    <meta
      property="og:title"
      content="Oxford AQA A-Level Grade Boundaries 2020-2025 | Download CSV & Charts"
    />
    <meta
      property="og:description"
      content="Free interactive Oxford AQA grade-boundary data (2020-2025) with table view, trend charts & CSV download."
    />
    <meta
      property="og:image"
      content="https://gradeboundaries.com/preview.png"
    />
    <meta
      property="og:image:alt"
      content="Screenshot of Oxford AQA grade boundaries page"
    />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://gradeboundaries.com/International_A_levels/OxfordAqa" />
    <meta
      name="twitter:title"
      content="Oxford AQA A-Level Grade Boundaries 2020-2025"
    />
    <meta
      name="twitter:description"
      content="Interactive Oxford AQA grade-boundary tables, charts & CSV download."
    />
    <meta
      name="twitter:image"
      content="https://gradeboundaries.com/preview.png"
    />

    <!-- Structured data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "Oxford AQA Grade Boundaries",
        "url": "https://gradeboundaries.com/International_A_levels/OxfordAqa",
        "breadcrumb": {
          "@type": "BreadcrumbList",
          "itemListElement": [
            {
              "@type": "ListItem",
              "position": 1,
              "name": "Home",
              "item": "https://gradeboundaries.com/"
            },
            {
              "@type": "ListItem",
              "position": 2,
              "name": "Oxford AQA",
              "item": "https://gradeboundaries.com/International_A_levels/OxfordAqa"
            }
          ]
        }
      }
    </script>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Dataset",
        "name": "Oxford AQA A-Level Grade Boundaries 2020-2025",
        "description": "Dataset of Oxford AQA A-Level grade-boundary marks for all available units and exam sessions between 2020 and 2025.",
        "url": "https://gradeboundaries.com/International_A_levels/OxfordAqa",
        "sameAs": "https://github.com/ChessMastermind/oxfordaqa-grade-boundaries",
        "creator": {
          "@type": "Person",
          "name": "ChessMastermind",
          "url": "https://github.com/ChessMastermind"
        },
        "keywords": [
          "Oxford AQA",
          "A Level",
          "grade boundaries",
          "2020",
          "2021",
          "2022",
          "2023",
          "2024",
          "2025"
        ],
        "temporalCoverage": "2020-01-01/2025-12-31",
        "isAccessibleForFree": true
      }
    </script>

    <!-- Instant-load theme (kept) -->
    <script>
      (() => {
        const s = localStorage.getItem("theme");
        if (
          s === "dark" ||
          (!s && matchMedia("(prefers-color-scheme: dark)").matches)
        ) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>

    <!-- ─── PERFORMANCE HINTS ─── -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="preconnect" href="https://cdn.datatables.net" />
    <link rel="preconnect" href="https://code.jquery.com" />

    <!-- Tailwind -->
    <!-- PapaParse -->
    <script
      src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"
      defer
    ></script>

    <!-- DataTables CSS (preload) -->
    <link
      rel="preload"
      href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
      as="style"
      onload="this.rel='stylesheet'"
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
    /></noscript>
    <link
      rel="preload"
      href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css"
      as="style"
      onload="this.rel='stylesheet'"
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css"
    /></noscript>
  </head>

  <body class="text-gray-800 flex flex-col min-h-screen">
    <header class="text-white text-center py-6 shadow-lg">
      <h1 class="page-title">Oxford&nbsp;AQA Grade Boundaries</h1>
      <button id="theme-toggle" class="absolute top-4 right-4">🌙</button>
      <nav
        class="mt-4 flex flex-col md:flex-row items-center justify-center gap-2"
        aria-label="Primary"
      >
        <a href="" class="nav-link mx-4 text-base sm:text-lg hover:text-white transition" title="Home">Home</a>
        <a
          href="International_A_levels/Edexcel"
          class="nav-link mx-4 text-base sm:text-lg hover:text-white transition"
          title="Edexcel A-Level grade boundaries 2015-2025"
          >Edexcel</a
        >
        <a
          href="International_A_levels/CIE"
          class="nav-link mx-4 text-base sm:text-lg hover:text-white transition"
          title="CIE (Cambridge International) A-Level grade boundaries"
          >CIE</a
        >
        <a
          href="International_A_levels/OxfordAqa"
          class="nav-link mx-4 text-base sm:text-lg hover:text-white transition"
          title="Oxford AQA A-Level grade boundaries 2020-2025"
          >Oxford AQA</a
        >
      </nav>
    </header>

    <main class="flex-1 w-full px-4">
      <section
        class="bg-white rounded-lg shadow-md p-6 w-full max-w-7xl mx-auto"
      >
        <h2 class="text-2xl font-semibold mb-4">
          Oxford&nbsp;AQA Grade Boundaries
        </h2>

        <!-- TABLE -->
        <div class="table-wrapper mb-6">
          <table
            id="OxfordAqaTable"
            class="display nowrap responsive w-full"
            aria-describedby="grade-boundaries-caption"
          >
            <caption id="grade-boundaries-caption" class="sr-only">
              Oxford AQA grade boundaries per unit code
            </caption>
            <thead>
              <tr></tr>
            </thead>
          </table>
        </div>

        <!-- CSV DOWNLOAD -->
        <div class="text-right my-4">
          <button
            id="downloadCSV"
            class="class-button px-4 py-2 rounded hover:bg-[#2b7a78] transition"
          >
            Download CSV
          </button>
        </div>

        <!-- CONTROLS -->
        <div id="aqa-controls" class="flex flex-wrap gap-4 mb-6 items-center">
          <label for="aqaUnitSearch" class="font-semibold"
            >Unit&nbsp;Code:</label
          >
          <input
            type="text"
            id="aqaUnitSearch"
            placeholder="e.g. CH01"
            class="border rounded px-2 py-1 w-40 sm:w-auto"
            list="aqaUnitList"
          />
          <datalist id="aqaUnitList"></datalist>
        </div>

        <!-- CHART -->
        <div class="chart-container"><canvas id="OxfordAqaChart"></canvas></div>
      </section>
    </main>

    <!-- Footer -->
<footer class="mt-12" role="contentinfo">
      <div class="container mx-auto flex flex-col items-center py-6 px-4">
        <p class="text-lg">Created by</p>
        <nav aria-label="Created by">
          <ul class="flex space-x-4 text-lg">
            <li>
              <p>&nbsp;&nbsp;&nbsp;&nbsp;
              <a href="https://github.com/Fire-Frog-Fuel/" class="underline">
                Fire-Frog-Fuel
              </a></p>
            </li>
            <li>
              <span>&nbsp;and&nbsp;</span>
            </li>
            <li>
              <a href="https://github.com/ChessMastermind" class="underline">
                ChessMastermind
              </a>
            </li>
          </ul>
        </nav>

        <!-- Utility links -->
        <nav aria-label="Footer links">
          <ul class="flex space-x-4 text-lg">
            <li>
              <p>&nbsp;&nbsp;&nbsp;&nbsp;
              <a href="Contact" class="underline"> Contact us </a></p>
            </li>
            <li>
              <span>&nbsp;|&nbsp;</span>
            </li>
            <li>
              <a href="Privacy" class="underline"> Privacy Notice </a>
            </li>
          </ul>
        </nav>
      </div>
    </footer>
    <!-- PAGE SCRIPT -->
    <script defer>
      const loadScript = (src) =>
        new Promise((res) => {
          const s = document.createElement("script");
          s.src = src;
          s.onload = res;
          document.body.appendChild(s);
        });

      window.addEventListener("DOMContentLoaded", () => {
        fetch("csv/International_A_levels/OxfordAqa.csv")
          .then((r) => r.text())
          .then(
            (csvText) =>
              new Promise((resolve) => {
                Papa.parse(csvText, {
                  header: true,
                  dynamicTyping: true,
                  skipEmptyLines: true,
                  worker: true,
                  complete: ({ data }) => resolve([data, csvText]),
                });
              }),
          )
          .then(async ([parsed, csvText]) => {
            await loadScript("https://code.jquery.com/jquery-3.6.0.min.js");
            await loadScript(
              "https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js",
            ); // line 237
            await loadScript(
              "https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js",
            ); // line 238
            await loadScript("https://cdn.jsdelivr.net/npm/chart.js"); // line 239
            initPage(parsed, csvText);
          })
          .catch((err) => {
            console.error(err);
            document.getElementById("OxfordAqaTable").innerHTML =
              '<tbody><tr><td colspan="10" class="text-center py-4">Failed to load data.</td></tr></tbody>';
          });
      });

      function initPage(parsed, csvText) {
        // Remove any component-like columns
        const componentAliases = ["component", "Component", "paper", "part"];
        const headers = Object.keys(parsed[0] || {}).filter(
          (h) => !componentAliases.includes(h),
        );
        const dtColumns = headers.map((h) => ({ data: h, title: h }));
        $("#OxfordAqaTable").DataTable({
          data: parsed,
          columns: dtColumns,
          responsive: true,
          autoWidth: false,
          deferRender: true,
          pageLength: 10,
        });

        // Build unit→session→grades structure
        const gradeList = headers.filter(
          (h) =>
            !["year", "session", "code", "unit", "max_mark"].includes(
              h.toLowerCase(),
            ),
        );
        const dataByUnit = {};
        parsed.forEach((r) => {
          const unit = r.code || r.unit || r.subject || "";
          const session = `${r.year || ""} ${(r.session || "").trim()}`.trim();
          if (!unit || !session) return;
          dataByUnit[unit] ??= {};
          dataByUnit[unit][session] ??= {};
          gradeList.forEach((g) => {
            const v = parseFloat(r[g]);
            if (!isNaN(v)) dataByUnit[unit][session][g] = v;
          });
          const mm = parseFloat(r.max_mark);
          if (!isNaN(mm)) dataByUnit[unit][session].max_mark = mm;
        });

        // Populate datalist
        const unitInput = document.getElementById("aqaUnitSearch");
        const unitList = document.getElementById("aqaUnitList");
        Object.keys(dataByUnit)
          .sort()
          .forEach((u) =>
            unitList.appendChild(
              Object.assign(document.createElement("option"), { value: u }),
            ),
          );

        // Chart setup
        const ctx = document.getElementById("OxfordAqaChart").getContext("2d");
        let chart = null;
        const gradeColors = {};
        gradeList.forEach((g, i) => {
          gradeColors[g] = `hsl(${(i * 360) / gradeList.length},60%,50%)`;
        });
        const maxMarkColor = "#999999";
        const monthOrder = {
          Jan: 1,
          Feb: 2,
          Mar: 3,
          Apr: 4,
          May: 5,
          Jun: 6,
          Jul: 7,
          Aug: 8,
          Sep: 9,
          Oct: 10,
          Nov: 11,
          Dec: 12,
        };

        function updateChart() {
          const unit = unitInput.value.trim();
          if (!dataByUnit[unit]) {
            if (chart) {
              chart.destroy();
              chart = null;
            }
            return;
          }
          const dataObj = dataByUnit[unit];
          const sessions = Object.keys(dataObj);
          if (!sessions.length) {
            if (chart) {
              chart.destroy();
              chart = null;
            }
            return;
          }
          sessions.sort((a, b) => {
            const [ya, ma] = a.split(" ");
            const [yb, mb] = b.split(" ");
            return +ya - +yb || monthOrder[ma] - monthOrder[mb];
          });
          const datasets = gradeList.map((g) => ({
            label: g.toUpperCase(),
            data: sessions.map((s) => dataObj[s][g] ?? null),
            borderColor: gradeColors[g],
            tension: 0.2,
            fill: false,
          }));
          datasets.push({
            label: "Max Mark",
            data: sessions.map((s) => dataObj[s].max_mark ?? null),
            borderColor: maxMarkColor,
            borderDash: [5, 5],
            borderWidth: 1,
            pointRadius: 0,
            fill: false,
          });
          if (chart) chart.destroy();
          chart = new Chart(ctx, {
            type: "line",
            data: { labels: sessions, datasets },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                title: { display: true, text: `Grade Boundaries — ${unit}` },
                legend: { position: "bottom" },
              },
              scales: {
                x: { title: { display: true, text: "Exam Session" } },
                y: {
                  beginAtZero: true,
                  title: { display: true, text: "Marks" },
                },
              },
            },
          });
        }

        unitInput.addEventListener("input", updateChart);
        // Default to CH01 if present, else first unit
        unitInput.value = dataByUnit["CH01"]
          ? "CH01"
          : Object.keys(dataByUnit)[0] || "";
        updateChart();

        // CSV download
        document.getElementById("downloadCSV").addEventListener("click", () => {
          const blob = new Blob([csvText], { type: "text/csv" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "OxfordAqa.csv";
          a.click();
          URL.revokeObjectURL(url);
        });
      }
    </script>

    <script>
      const btn = document.getElementById("theme-toggle");
      const root = document.documentElement;

      /*  swap icon to match current state  */
      btn.textContent = root.classList.contains("dark") ? "☀️" : "🌙";

      btn.addEventListener("click", () => {
        const dark = root.classList.toggle("dark");
        localStorage.setItem("theme", dark ? "dark" : "light");
        btn.textContent = dark ? "☀️" : "🌙";
      });
    </script>
  </body>
</html>
